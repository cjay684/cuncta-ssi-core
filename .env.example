# Network: testnet / previewnet / mainnet
HEDERA_NETWORK=testnet
ALLOW_MAINNET=false
VITE_HEDERA_NETWORK=testnet

# Sponsor / fee payer (server-side). This key pays DID / anchoring fees.
# NEVER commit real keys. Replace placeholders locally.
# All REPLACE_ME values are placeholders and must be overridden in your env.
HEDERA_OPERATOR_ID=0.0.0000000
HEDERA_OPERATOR_PRIVATE_KEY=REPLACE_ME
HEDERA_OPERATOR_ID_DID=0.0.0000000
HEDERA_OPERATOR_PRIVATE_KEY_DID=REPLACE_ME
HEDERA_OPERATOR_ID_ANCHOR=0.0.0000000
HEDERA_OPERATOR_PRIVATE_KEY_ANCHOR=REPLACE_ME
ALLOW_LEGACY_OPERATOR_KEYS=false
HEDERA_PAYER_ACCOUNT_ID=0.0.0000000
HEDERA_PAYER_PRIVATE_KEY=REPLACE_ME
VITE_HEDERA_OPERATOR_ID=0.0.0000000
VITE_HEDERA_OPERATOR_PRIVATE_KEY=REPLACE_ME

# Optional topic ids (you can leave empty for MVP)
HEDERA_DID_TOPIC_ID=
HEDERA_ANCHOR_TOPIC_ID=

# Service base URLs
APP_GATEWAY_BASE_URL=http://localhost:3010
DID_SERVICE_BASE_URL=http://localhost:3001
ISSUER_SERVICE_BASE_URL=http://localhost:3002
VERIFIER_SERVICE_BASE_URL=http://localhost:3003
POLICY_SERVICE_BASE_URL=http://localhost:3004

# Optional dynamic ports (integration tests only)
# DYNAMIC_PORTS=1
# DID_SERVICE_PORT=3001
# ISSUER_SERVICE_PORT=3002
# VERIFIER_SERVICE_PORT=3003
# POLICY_SERVICE_PORT=3004
# APP_GATEWAY_PORT=3010

# Issuer configuration
ISSUER_BASE_URL=http://localhost:3002
# Leave ISSUER_DID unset in most setups; issuer-service bootstraps and persists it.
ISSUER_DID=
ISSUER_JWK={"crv":"Ed25519","d":"REPLACE_ME","x":"REPLACE_ME","kty":"OKP","kid":"issuer-1"}
# ISSUER_JWKS is for dev/test only; must be empty/unset in production.
ISSUER_JWKS=
ISSUER_INTERNAL_ALLOWED_VCTS=cuncta.marketplace.seller_good_standing,cuncta.age_over_18
ISSUER_KEYS_BOOTSTRAP=true
ISSUER_KEYS_ALLOW_DB_PRIVATE=true

# Database (dev default; override in production)
DATABASE_URL=postgres://cuncta:cuncta@localhost:5432/cuncta_ssi
# Optional dedicated migration credential/role (recommended in production)
MIGRATIONS_DATABASE_URL=

# Challenge TTL seconds
CHALLENGE_TTL_SECONDS=180

# Wallet KB-JWT TTL (seconds)
KBJWT_TTL_SECONDS=120

# Cleanup/retention (issuer-service)
CLEANUP_WORKER_POLL_MS=3600000
ANCHOR_MAX_ATTEMPTS=25
RETENTION_VERIFICATION_CHALLENGES_DAYS=7
RETENTION_RATE_LIMIT_EVENTS_DAYS=7
RETENTION_OBLIGATION_EVENTS_DAYS=30
RETENTION_AURA_SIGNALS_DAYS=90
RETENTION_AUDIT_LOGS_DAYS=90

# Privacy/DSR (issuer-service)
PRIVACY_CHALLENGE_TTL_SECONDS=180
PRIVACY_TOKEN_TTL_SECONDS=900

# Service-to-service auth (optional in dev)
# Use >=32 chars. Recommended: base64url (>=43 chars) or hex (>=64 chars).
SERVICE_JWT_SECRET=change-me-please-use-32-characters-minimum
SERVICE_JWT_SECRET_DID=change-me-please-use-32-characters-minimum-did
SERVICE_JWT_SECRET_ISSUER=change-me-please-use-32-characters-minimum-issuer
SERVICE_JWT_SECRET_VERIFIER=change-me-please-use-32-characters-minimum-verifier
SERVICE_JWT_SECRET_NEXT=
ALLOW_LEGACY_SERVICE_JWT_SECRET=false
# Defaults to true in production if unset.
SERVICE_JWT_SECRET_FORMAT_STRICT=true
SERVICE_JWT_AUDIENCE=cuncta-internal
SERVICE_JWT_AUDIENCE_DID=cuncta.service.did
SERVICE_JWT_AUDIENCE_ISSUER=cuncta.service.issuer
SERVICE_JWT_AUDIENCE_VERIFIER=cuncta.service.verifier
ALLOW_INSECURE_DEV_AUTH=false

# Network binding / exposure (production must be private)
# Use 127.0.0.1 / RFC1918 / ULA; 0.0.0.0 is for dev/test only.
SERVICE_BIND_ADDRESS=127.0.0.1
LOCAL_DEV=false
PUBLIC_SERVICE=false
TRUST_PROXY=false
AUTO_MIGRATE=true
STRICT_DB_ROLE=false
ENFORCE_HTTPS_INTERNAL=false
# Backup/restore safety (maintenance mode)
BACKUP_RESTORE_MODE=false

# App gateway (public onboarding + rate limits)
ALLOW_SPONSORED_ONBOARDING=true
ALLOW_SELF_FUNDED_ONBOARDING=true
ONBOARDING_STRATEGY_DEFAULT=sponsored
ONBOARDING_STRATEGY_ALLOWED=sponsored,user_pays
# For web-demo (Vite needs VITE_ prefix)
VITE_ONBOARDING_STRATEGY_DEFAULT=sponsored
VITE_ONBOARDING_STRATEGY_ALLOWED=sponsored,user_pays
GATEWAY_VERIFY_DEBUG_REASONS=false
GATEWAY_ALLOWED_VCTS=cuncta.marketplace.seller_good_standing,cuncta.age_over_18
GATEWAY_REQUIREMENTS_ALLOWED_ACTIONS=marketplace.list_item
REQUIRE_DEVICE_ID_FOR_REQUIREMENTS=false
RATE_LIMIT_IP_DID_REQUEST_PER_MIN=10
RATE_LIMIT_IP_DID_SUBMIT_PER_MIN=5
RATE_LIMIT_IP_ISSUE_PER_MIN=10
RATE_LIMIT_IP_VERIFY_PER_MIN=60
RATE_LIMIT_DEVICE_REQUIREMENTS_PER_MIN=60
RATE_LIMIT_DEVICE_DID_PER_DAY=3
RATE_LIMIT_DEVICE_ISSUE_PER_MIN=10
USER_PAYS_REQUEST_TTL_SECONDS=300
USER_PAYS_MAX_TX_BYTES=32768
USER_PAYS_MAX_FEE_TINYBARS=50000000
USER_PAYS_HANDOFF_SECRET=change-me-user-pays-handoff-secret
BODY_LIMIT_BYTES=65536
SPONSOR_MAX_DID_CREATES_PER_DAY=500
SPONSOR_MAX_ISSUES_PER_DAY=2000
SPONSOR_KILL_SWITCH=false
CONTRACT_E2E_ENABLED=false
CONTRACT_E2E_ADMIN_TOKEN=change-me-contract-admin-token
# IP allowlist supports IPv4/IPv6 (CIDR) and IPv4-mapped IPv6 (::ffff:x.x.x.x).
# IPv4-embedded IPv6 (e.g. 2001:db8::192.0.2.1) is not supported; use pure IPv4/IPv6 CIDRs.
CONTRACT_E2E_IP_ALLOWLIST=

# Pseudonymizer
# - PSEUDONYMIZER_PEPPER is required in production.
# - In dev/test, if missing, a random in-memory pepper is generated (hashes change on restart).
# - PSEUDONYMIZER_ALLOW_LEGACY defaults true in dev/test, false in production.
#   When true, reads match legacy SHA-256 and new HMAC hashes; new writes always use HMAC.
#   Enabling legacy in production is prohibited (startup failure).
PSEUDONYMIZER_PEPPER=change-me
PSEUDONYMIZER_ALLOW_LEGACY=true

# Verifier status list fetch/cache
STATUS_LIST_FETCH_TIMEOUT_MS=2500
STATUS_LIST_CACHE_TTL_SECONDS=10
STATUS_LIST_CACHE_MAX_ENTRIES=64
# Verifier request size limits
VERIFY_MAX_PRESENTATION_BYTES=65536
VERIFY_MAX_NONCE_CHARS=256
VERIFY_MAX_AUDIENCE_CHARS=256
VERIFY_MAX_DISCLOSURES=100

# Policy/catalog integrity + anchor authenticity
POLICY_SIGNING_JWK={"crv":"Ed25519","d":"REPLACE_ME","x":"REPLACE_ME","kty":"OKP","kid":"policy-1"}
POLICY_SIGNING_BOOTSTRAP=true
ANCHOR_AUTH_SECRET=change-me-anchor-secret

# Wallet CLI local file storage
WALLET_STATE_FILE=wallet-state.json